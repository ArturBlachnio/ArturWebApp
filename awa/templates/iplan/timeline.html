{% extends "layout.html" %}
{% block content %}
<div class="container">
    <div class="row content-section">
        {% for timeline in timeline_ranges()%}
        <div class="col-md-4 border p-1 rounded">
            <div class="col-12 border timeline_task_border rounded p-0">
            <small class="timeline_header">{{ timeline[2] }}</small>
                {% for task in tasks %}
                    {% if task.time_line >= fromordinal(timeline[0]) and task.time_line < fromordinal(timeline[1]) %}
                        <!-- Name -->
                         <div class="row rounded-top border border-bottom-0 border-secondary timeline_task_name pl-1 pb-1 ml-1 mr-1" style="background-color:{{task.strategy.color}}">
                            {{task.name}}
                        </div>
                        <!-- Buttons -->
                        <div class="row rounded-bottom border border-top-0 border-secondary timeline_task_buttons mb-1 ml-1 mr-1" style="background-color:{{task.strategy.color}}">
                                {% if task.timer_start %}
                                    <a href="{{url_for('iplan.task_timer_start', id_task=task.id) }}" class="badge badge-light">Reset</a>
                                    <a href="{{url_for('iplan.task_timer_end', id_task=task.id) }}" class="badge badge-danger">Stop</a>
                                {% else %}
                                    <a href="{{url_for('iplan.task_timer_start', id_task=task.id) }}" class="badge badge-light">Start</a>
                                    {% if task.time_completion %}
                                        <a href="{{url_for('iplan.task_restore', id_task=task.id)}}" class="badge badge-primary">Restore</a>
                                    {% else %}
                                        {% if task.frequency == 'OneTime' %}
                                            <a href="{{url_for('iplan.task_complete', id_task=task.id)}}" class="badge badge-success">Done</a>
                                        {% else %}
                                            <a href="{{url_for('iplan.task_complete', id_task=task.id)}}" class="badge badge-success">Done+</a>
                                        {% endif %}
                                    {% endif %}
                                {% endif%}
                                {% if task.timer_start %}
                                <a href="#" class="badge badge-warning">{{string_from_duration(now - task.timer_start)}}</a>
                                {% endif %}
                                <a href="#" class="badge badge-info">{{string_from_duration(task.duration_real)}}</a>
                                <a href="#" class="badge badge-light">{{string_from_duration(task.duration_plan)}}</a>
                                <a href="{{url_for('iplan.task_update', id_task=task.id) }}" class="badge badge-secondary">Update</a>
                                <a href="{{url_for('iplan.task_delete', id_task=task.id) }}" class="badge badge-danger">Del</a>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock content %}

